{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { withAuth } from \"next-auth/middleware\";\nimport { NextResponse } from \"next/server\";\n\nexport default withAuth(\n    function middleware(req) {\n        const token = req.nextauth.token;\n        const path = req.nextUrl.pathname;\n\n        // RBAC: Role-based access control\n        if (path.startsWith(\"/admin\") && token?.role !== \"ADMIN\") {\n            return NextResponse.redirect(new URL(\"/unauthorized\", req.url));\n        }\n        if (path.startsWith(\"/trainer\") && ![\"TRAINER\", \"ADMIN\"].includes(token?.role as string)) {\n            return NextResponse.redirect(new URL(\"/unauthorized\", req.url));\n        }\n        if (path.startsWith(\"/approver\") && ![\"APPROVER\", \"ADMIN\"].includes(token?.role as string)) {\n            return NextResponse.redirect(new URL(\"/unauthorized\", req.url));\n        }\n        // Sales can access most things including /request but not trainer/admin/approver specific dashboards\n\n        return NextResponse.next();\n    },\n    {\n        callbacks: {\n            authorized: ({ token }) => !!token,\n        },\n    }\n);\n\nexport const config = {\n    matcher: [\n        \"/admin/:path*\",\n        \"/trainer/:path*\",\n        \"/approver/:path*\",\n        \"/request/:path*\",\n        \"/requests/:path*\",\n    ],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;;;uCAEe,IAAA,8JAAQ,EACnB,SAAS,WAAW,GAAG;IACnB,MAAM,QAAQ,IAAI,QAAQ,CAAC,KAAK;IAChC,MAAM,OAAO,IAAI,OAAO,CAAC,QAAQ;IAEjC,kCAAkC;IAClC,IAAI,KAAK,UAAU,CAAC,aAAa,OAAO,SAAS,SAAS;QACtD,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;IACjE;IACA,IAAI,KAAK,UAAU,CAAC,eAAe,CAAC;QAAC;QAAW;KAAQ,CAAC,QAAQ,CAAC,OAAO,OAAiB;QACtF,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;IACjE;IACA,IAAI,KAAK,UAAU,CAAC,gBAAgB,CAAC;QAAC;QAAY;KAAQ,CAAC,QAAQ,CAAC,OAAO,OAAiB;QACxF,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,IAAI,GAAG;IACjE;IACA,qGAAqG;IAErG,OAAO,gMAAY,CAAC,IAAI;AAC5B,GACA;IACI,WAAW;QACP,YAAY,CAAC,EAAE,KAAK,EAAE,GAAK,CAAC,CAAC;IACjC;AACJ;AAGG,MAAM,SAAS;IAClB,SAAS;QACL;QACA;QACA;QACA;QACA;KACH;AACL"}}]
}