{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/davidyoung/Desktop/Valve%20Academy%20web/src/app/actions/workflow.ts"],"sourcesContent":["\"use server\";\n\nimport { canTransition, getNextStatus } from \"@/lib/workflow\";\nimport prisma from \"@/lib/prisma\";\nimport { getServerSession } from \"next-auth\";\nimport { authOptions } from \"@/lib/auth\";\nimport { revalidatePath } from \"next/cache\";\n\nexport async function processWorkflowAction(\n    requestId: string,\n    action: \"APPROVE\" | \"REJECT\",\n    reason?: string\n) {\n    const session = await getServerSession(authOptions);\n    if (!session || !session.user) return { error: \"Unauthorized\" };\n\n    const userRole = (session.user as any).role;\n    // TODO: Add strict RBAC check based on current status vs user role\n\n    const request = await prisma.trainingRequest.findUnique({\n        where: { id: requestId },\n    });\n\n    if (!request) return { error: \"Request not found\" };\n\n    const nextStatus = getNextStatus(request.status, action, request.discountPercent);\n\n    if (!canTransition(request.status, nextStatus)) {\n        return { error: `Invalid transition from ${request.status} to ${nextStatus}` };\n    }\n\n    // Update Request\n    await prisma.trainingRequest.update({\n        where: { id: requestId },\n        data: {\n            status: nextStatus,\n            approvals: {\n                create: {\n                    userId: (session.user as any).id,\n                    stage: request.status,\n                    decision: action,\n                    reason: reason,\n                },\n            },\n            // If CONFIRMED, we might want to create the final CalendarEvent here\n        },\n    });\n\n    if (nextStatus === \"CONFIRMED\") {\n        // Create Confirmed Calendar Event\n        if (request.trainerId) {\n            // Check if one exists first?\n            // Just create new confirmed event\n            await prisma.calendarEvent.create({\n                data: {\n                    requestId: request.id,\n                    trainerId: request.trainerId,\n                    start: request.startDate,\n                    end: request.endDate,\n                    type: \"CONFIRMED\",\n                }\n            });\n\n            // Also maybe delete TENTATIVE ones?\n        }\n    }\n\n    // TODO: Trigger Email Notifications\n\n    revalidatePath(`/requests/${request.reference}`);\n    revalidatePath(\"/trainer/inbox\");\n    revalidatePath(\"/approver/inbox\");\n    return { success: true };\n}\n"],"names":[],"mappings":";;;;;;;MAQsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,yDAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/davidyoung/Desktop/Valve%20Academy%20web/src/components/WorkflowActions.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { processWorkflowAction } from \"@/app/actions/workflow\";\nimport { CheckCircle, XCircle } from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\n\nexport default function WorkflowActions({ requestId, currentStatus, userRole }: { requestId: string, currentStatus: string, userRole: string }) {\n    const router = useRouter();\n    const [loading, setLoading] = useState(false);\n\n    const handleAction = async (action: \"APPROVE\" | \"REJECT\") => {\n        if (!confirm(`Are you sure you want to ${action} this request?`)) return;\n\n        setLoading(true);\n        const res = await processWorkflowAction(requestId, action);\n        setLoading(false);\n\n        if (res.success) {\n            router.refresh();\n        } else {\n            alert(res.error || \"Action failed\");\n        }\n    };\n\n    // Determine if buttons should be shown based on role and status\n    // Logic matches workflow.ts but simplified for UI\n    const showTrainerActions = userRole === \"TRAINER\" && currentStatus === \"AWAITING_TRAINER_CONFIRMATION\";\n    const showApproverActions = userRole === \"APPROVER\" && (currentStatus.startsWith(\"AWAITING_APPROVER\"));\n    const showAdminActions = userRole === \"ADMIN\"; // Admin can force things? Ideally explicit state check too\n\n    if (!showTrainerActions && !showApproverActions && !showAdminActions) return null;\n\n    // Refine: Admin shouldn't see it unless they are acting as that role or we have explicit Admin overrides.\n    // For MVP, lets just stick to the strict workflow logic + Admin override.\n    // Actually, specifically for MVP:\n    // Trainer sees buttons if status is AWAITING_TRAINER_CONFIRMATION\n    // Approver sees buttons if status is AWAITING_APPROVER_1 or 2\n\n\n    // Hide if terminal\n    if ([\"CONFIRMED\", \"REJECTED\", \"NO_TRAINER_AVAILABLE\"].includes(currentStatus)) return null;\n\n    return (\n        <div className=\"card border-celeros-blue-100 bg-celeros-blue-50 mt-6\">\n            <h3 className=\"text-lg font-bold mb-4 text-celeros-blue-800\">Actions Required</h3>\n            <div className=\"flex gap-4\">\n                <button\n                    onClick={() => handleAction(\"APPROVE\")}\n                    disabled={loading}\n                    className=\"btn bg-green-600 hover:bg-green-700 text-white\"\n                >\n                    <CheckCircle size={18} /> {userRole === \"TRAINER\" ? \"Confirm Availability\" : \"Approve Request\"}\n                </button>\n                <button\n                    onClick={() => handleAction(\"REJECT\")}\n                    disabled={loading}\n                    className=\"btn bg-red-600 hover:bg-red-700 text-white\"\n                >\n                    <XCircle size={18} /> Reject\n                </button>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AACA;;;AALA;;;;;AAOe,SAAS,gBAAgB,EAAE,SAAS,EAAE,aAAa,EAAE,QAAQ,EAAkE;;IAC1I,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,eAAe,OAAO;QACxB,IAAI,CAAC,QAAQ,CAAC,yBAAyB,EAAE,OAAO,cAAc,CAAC,GAAG;QAElE,WAAW;QACX,MAAM,MAAM,MAAM,IAAA,yLAAqB,EAAC,WAAW;QACnD,WAAW;QAEX,IAAI,IAAI,OAAO,EAAE;YACb,OAAO,OAAO;QAClB,OAAO;YACH,MAAM,IAAI,KAAK,IAAI;QACvB;IACJ;IAEA,gEAAgE;IAChE,kDAAkD;IAClD,MAAM,qBAAqB,aAAa,aAAa,kBAAkB;IACvE,MAAM,sBAAsB,aAAa,cAAe,cAAc,UAAU,CAAC;IACjF,MAAM,mBAAmB,aAAa,SAAS,2DAA2D;IAE1G,IAAI,CAAC,sBAAsB,CAAC,uBAAuB,CAAC,kBAAkB,OAAO;IAE7E,0GAA0G;IAC1G,0EAA0E;IAC1E,kCAAkC;IAClC,kEAAkE;IAClE,8DAA8D;IAG9D,mBAAmB;IACnB,IAAI;QAAC;QAAa;QAAY;KAAuB,CAAC,QAAQ,CAAC,gBAAgB,OAAO;IAEtF,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC;gBAAG,WAAU;0BAA+C;;;;;;0BAC7D,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBACG,SAAS,IAAM,aAAa;wBAC5B,UAAU;wBACV,WAAU;;0CAEV,6LAAC,6OAAW;gCAAC,MAAM;;;;;;4BAAM;4BAAE,aAAa,YAAY,yBAAyB;;;;;;;kCAEjF,6LAAC;wBACG,SAAS,IAAM,aAAa;wBAC5B,UAAU;wBACV,WAAU;;0CAEV,6LAAC,0NAAO;gCAAC,MAAM;;;;;;4BAAM;;;;;;;;;;;;;;;;;;;AAKzC;GAzDwB;;QACL,kJAAS;;;KADJ"}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/davidyoung/Desktop/Valve%20Academy%20web/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-client-wrapper.ts"],"sourcesContent":["// This file must be bundled in the app's client layer, it shouldn't be directly\n// imported by the server.\n\nexport { callServer } from 'next/dist/client/app-call-server'\nexport { findSourceMapURL } from 'next/dist/client/app-find-source-map-url'\n\n// A noop wrapper to let the Flight client create the server reference.\n// See also: https://github.com/facebook/react/pull/26632\n// eslint-disable-next-line import/no-extraneous-dependencies\nexport { createServerReference } from 'react-server-dom-webpack/client'\n"],"names":["callServer","createServerReference","findSourceMapURL"],"mappings":"AAAA,gFAAgF;AAChF,0BAA0B;;;;;;;;;;;;;;;;IAEjBA,UAAU,EAAA;eAAVA,eAAAA,UAAU;;IAMVC,qBAAqB,EAAA;eAArBA,QAAAA,qBAAqB;;IALrBC,gBAAgB,EAAA;eAAhBA,qBAAAA,gBAAgB;;;+BADE;qCACM;wBAKK","ignoreList":[0]}},
    {"offset": {"line": 185, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/circle-check-big.js","sources":["file:///Users/davidyoung/Desktop/Valve%20Academy%20web/node_modules/lucide-react/src/icons/circle-check-big.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M21.801 10A10 10 0 1 1 17 3.335', key: 'yps3ct' }],\n  ['path', { d: 'm9 11 3 3L22 4', key: '1pflzl' }],\n];\n\n/**\n * @component @name CircleCheckBig\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuODAxIDEwQTEwIDEwIDAgMSAxIDE3IDMuMzM1IiAvPgogIDxwYXRoIGQ9Im05IDExIDMgM0wyMiA0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/circle-check-big\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CircleCheckBig = createLucideIcon('circle-check-big', __iconNode);\n\nexport default CircleCheckBig;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAmC,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IAChE;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAkB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CACjD;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,cAAA,CAAA,CAAA,KAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,iKAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAoB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA"}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/lucide-react/dist/esm/icons/circle-x.js","sources":["file:///Users/davidyoung/Desktop/Valve%20Academy%20web/node_modules/lucide-react/src/icons/circle-x.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['path', { d: 'm15 9-6 6', key: '1uzhvr' }],\n  ['path', { d: 'm9 9 6 6', key: 'z0biqf' }],\n];\n\n/**\n * @component @name CircleX\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cGF0aCBkPSJtMTUgOS02IDYiIC8+CiAgPHBhdGggZD0ibTkgOSA2IDYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/circle-x\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CircleX = createLucideIcon('circle-x', __iconNode);\n\nexport default CircleX;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,QAAA,CAAA;QAAU,CAAA;YAAE,EAAA,CAAA,CAAI,CAAA,CAAA,CAAA,CAAA;YAAM,CAAA,CAAA,CAAA,CAAI,IAAA,CAAA;YAAM,CAAA,EAAG,CAAA,CAAA,CAAA,CAAA,CAAA;YAAM,GAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IACzD;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAa,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IAC1C;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAY,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CAC3C;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,OAAA,CAAA,CAAA,KAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,iKAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA"}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":["file:///Users/davidyoung/Desktop/Valve%20Academy%20web/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0]}}]
}